<!DOCTYPE html>
<html>
  <head>
    <title><%= content_for(:title) || "Job Mailer" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Job Mailer">
    <meta name="mobile-web-app-capable" content="yes">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= yield :head %>

    <%# Enable PWA manifest for installable apps (make sure to enable in config/routes.rb too!) %>
    <%#= tag.link rel: "manifest", href: pwa_manifest_path(format: :json) %>

    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/icon.png">

    <%# Includes all stylesheet files in app/assets/stylesheets %>
    <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
    <script src="https://cdn.tailwindcss.com"></script>
    <%= javascript_importmap_tags %>
  </head>

  <body class="bg-cover bg-center bg-fixed bg-no-repeat min-h-screen" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); position: relative;">
    <!-- Animated background pattern -->
    <div class="fixed inset-0 opacity-20 pointer-events-none" style="background-image: url('data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22100%22 height=%22100%22%3E%3Cg fill=%22white%22 opacity=%220.3%22%3E%3Ccircle cx=%2210%22 cy=%2210%22 r=%224%22/%3E%3Ccircle cx=%2250%22 cy=%2230%22 r=%226%22/%3E%3Ccircle cx=%2280%22 cy=%2260%22 r=%225%22/%3E%3Crect x=%2220%22 y=%2220%22 width=%2215%22 height=%2225%22/%3E%3Crect x=%2260%22 y=%2250%22 width=%2220%22 height=%2215%22/%3E%3Cpath d=%22M5 50 Q25 40, 45 50%22 stroke=%22white%22 stroke-width=%221.5%22 fill=%22none%22/%3E%3Cpath d=%22M60 20 L70 35 L75 20%22 stroke=%22white%22 stroke-width=%221.5%22 fill=%22none%22/%3E%3C/g%3E%3C/svg%3E'); background-size: 300px 300px; background-repeat: repeat;"></div>
    <header class="p-4 flex justify-between items-center">
      <div class="text-white font-bold"><%= link_to 'Job Mailer', root_path %></div>
      <nav>
        <% if defined?(user_signed_in?) && user_signed_in? %>
          <span class="text-white mr-4">Signed in as <%= current_user.email %></span>
          <%= link_to 'Templates', email_templates_path, class: 'text-white mr-4' %>
          <%= link_to 'Logs', email_logs_path, class: 'text-white mr-4' %>
          <% if respond_to?(:edit_setting_path) %>
            <%= link_to 'Settings', edit_setting_path, class: 'text-white mr-4' %>
          <% end %>
          <% if respond_to?(:destroy_user_session_path) %>
            <%#= link_to 'Sign out', destroy_user_session_path, data: { turbo_method: :delete }, class: 'text-white' %>
            <%= button_to 'Sign out', destroy_user_session_path, method: :delete , class: 'text-white bg-transparent border-0 p-0' %>
          <% end %>
        <% else %>
          <% if respond_to?(:new_user_session_path) %>
            <%= link_to 'Sign in', new_user_session_path, class: 'text-white mr-4' %>
          <% end %>
          <% if respond_to?(:new_user_registration_path) %>
            <%= link_to 'Sign up', new_user_registration_path, class: 'text-white' %>
          <% end %>
        <% end %>
      </nav>
    </header>
    <%= render 'shared/toast' %>
    <main class="container mx-auto p-4">
      <%= yield %>
    </main>
  </body>
</html>
